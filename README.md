# Проект: Распознавание 35 пород кошек и собак

Данный проект выполняет классификацию изображений кошек и собак по 35 породам с использованием `PyTorch Lightning`. Для управления экспериментами используется `MLflow`, а для контроля данных — `DVC`.

---
## Основные возможности
- **Обучение модели**: Запуск процесса обучения с настраиваемыми параметрами.
- **Тестирование модели**: Оценка точности обученной модели на тестовых данных.
- **Инференс**: Классификация нового изображения.

---
## Структура проекта

```plaintext
├── README.md                    # Документация проекта
├── breeds_breeds                # Основной модуль проекта
│   ├── infer.py                 # Скрипт для инференса
│   ├── model.py                 # Определение модели
│   ├── test.py                  # Скрипт для тестирования
│   ├── train.py                 # Скрипт для обучения
│   └── trainer.py               # Обертка для обучения модели
├── build                        # Конфигурации для Docker
│   ├── Dockerfile               # Сборка образа проекта
│   └── mlflow_build             # Сборка mlflow
│       └── Dockerfile           # Файл сборки образа
├── commands.py                  # Скрипт для запуска через poetry
├── config.yaml                  # Общая конфигурация
├── data.dvc                     # DVC-файл для контроля данных
├── docker-compose.yaml          # Конфигурация для запуска с помощью Docker Compose
├── logs                         # Логи
├── models                       # Директория для сохранения моделей
├── poetry.lock                  # Файл Poetry зависимостей
└── pyproject.toml               # Конфигурация Poetry
```

---
## Команды для запуска

Используйте команды через `poetry` для выполнения основных операций:

Запуск обучения модели:
```bash
poetry poe start train
poetry poe start train train_config.num_epochs=30
```

Запуск тестирования модели:
```bash
poetry poe start test
```

Запуск классификации нового изображения:
```bash
poetry poe start infer infer_config.file_path=american_bulldog_120.jpg
```

---
## Конфигурация + Hydra
Все настройки проекта находятся в директории `config.yaml`. Для управления конфигурацией обучения допускается вносить изменения в данный файл.

---
## Зависимости
Для управления зависимостями используется Poetry. Все версии зависимостей зафиксированы в pyproject.toml.

Для версионирования и хранения датасета и моделей применяется DVC.

---
## Модель

МОдель разработана на фреймворке pytorch + pytorch-lightning. В качестве архитектуры с нуля выбрана сверточная нейронная сеть с 35 выходами (по количеству пород животных).

Оптимизатор - Adam
Лосс-функция - Кросс-энтропия
Метрика качества: accuracy
